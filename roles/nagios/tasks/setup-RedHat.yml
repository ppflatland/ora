# Variable configuration.
- include_vars: RedHat.yml

- name: Install EPEL repo
  ignore_errors: yes
  become: true
  yum:
    state: present
    name: epel-release
  
- name: Install common software requirements nagios
  ignore_errors: yes
  become: true
  yum:
    state: present
    name: 
      - nrpe 
      - nagios-plugins 
      - nagios-plugins-disk 
      - nagios-plugins-dummy 
      - nagios-plugins-load 
      - nagios-plugins-mysql 
      - nagios-plugins-procs

- name: Installing pip3
  ignore_errors: yes
  yum:
    name: python3-pip
    state: present
  when: ansible_distribution_major_version == '8'


- name: Installing pip2
  ignore_errors: yes
  yum:
    name: python2-pip
    state: present
  when: ansible_distribution_major_version == '7'


- name: Installing pip
  ignore_errors: yes
  yum:
    name: python-pip
    state: present
  when: ansible_distribution_major_version == '6'


- name: Installing mysql-python for dependency
  ignore_errors: yes
  pip:
    name: pymysql
    state: present

- name: Configuration nrpe
  template:
    src: "hoster_centos.j2"
    dest: "/etc/nrpe.d/hoster.cfg"
  notify: restart nrpe
